# ุชุญุณููุงุช ูุธุงู ุงูุฌุฏุงูู ุงููุฏุฑุณูุฉ

**ุงูุชุงุฑูุฎ:** 2026-01-01  
**ุงูุญุงูุฉ:** ููุฏ ุงูุชูููุฐ โ

---

## ๐ ููุฎุต ุงูุชุญุณููุงุช

ุชู ุฅุนุงุฏุฉ ุจูุงุก ูุธุงู ุงูุฌุฏุงูู ุงููุฏุฑุณูุฉ ูู ุงูุตูุฑ ุจูุงุกู ุนูู ุชุญููู ุฏููู ูููุดุงูู:

### โ ุงููุดุงูู ุงูุชู ุชู ุญููุง:
1. **ุจูุงูุงุช ููููุฉ** - ุชู ุญุฐู HRSchedules.tsx
2. **ุชุนููุฏ ุฒุงุฆุฏ** - ุชู ุชุจุณูุท SmartTimetablePro.tsx  
3. **ุนุฏู ุงูุงุณุชูุฑุงุฑ** - ุชู ุฅุนุงุฏุฉ ุจูุงุก TimetableManagement.tsx
4. **ูุดู ุงูุชุนุงุฑุถุงุช ุถุนูู** - ุชู ุชูููุฐ ูุธุงู ุญูููู
5. **ููุต ุงูุชูููุฏ ุงูุชููุงุฆู** - ุชู ุฅูุดุงุก ุฎูุงุฑุฒููุฉ ุฐููุฉ

---

## ๐ง ุงูุชุญุณููุงุช ุงููููุฐุฉ

### 1. **ุชุญุณูู useScheduleData Hook**

**ุงูููู:** `src/hooks/useScheduleData.ts`

#### โจ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ:
- โ ูุดู ุชุนุงุฑุถุงุช ุญูููู ุจุฏูู ูุดุงูู
- โ ุงูุชุญูู ูู ุงูุตุญุฉ ูุจู ุงูุญูุธ (Validation)
- โ ุญุณุงุจ ุงูุฅุญุตุงุฆูุงุช ุงูููุฑูุฉ
- โ ุฏุงูุฉ ุชุญุฏูุซ ุดุงููุฉ

#### ๐ ุชูุงุตูู ุงูุชุญุณููุงุช:

```typescript
// ูุดู ุงูุชุนุงุฑุถุงุช
detectConflictsForSlot(slot) {
  // ุชุนุงุฑุถ ุงููุนูู - ูุง ูููู ูููุนูู ุฃู ูููู ูู ุญุตุชูู
  // ุชุนุงุฑุถ ุงููุตู - ูุง ูููู ูููุตู ุฃู ูููู ูู ุญุตุชูู
  // ุชุนุงุฑุถ ุงููุงุนุฉ - ูุง ูููู ูููุงุนุฉ ุฃู ุชููู ูุดุบููุฉ ุจุญุตุชูู
}

// ุงูุชุญูู ูู ุงูุตุญุฉ
validateBeforeSave(slot) {
  // ุงูุชุญูู ูู ุงูุญููู ุงููุทููุจุฉ
  // ูุญุต ุงูุชุนุงุฑุถุงุช ูุจู ุงูุญูุธ
  // ุฅุฑุฌุงุน ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ
}
```

---

### 2. **ูุธุงู ุงูุชูููุฏ ุงูุชููุงุฆู ุงูุฐูู**

**ุงูููู:** `src/utils/scheduleAutoGenerate.ts`

#### โจ ุงูููุฒุงุช:
- โ ุชูุฒูุน ุชููุงุฆู ุฐูู ููุญุตุต
- โ ุงุญุชุฑุงู ุงููุตุงุจ ุงูุฃุณุจูุนู
- โ ุชุฌูุจ ุงูุชุนุงุฑุถุงุช ุงูุชููุงุฆู
- โ ุชูุงุฑูุฑ ููุตูุฉ ุนู ุงููุชุงุฆุฌ

#### ๐ฏ ุงูุฎูุงุฑุฒููุฉ:
```
1. ุฌูุน ุงูุจูุงูุงุช (ุฃูุงูุ ุญุตุตุ ุชูุฒูุนุงุช)
2. ุชุฌููุน ุงูุญุตุต ุญุณุจ ุงููุตู
3. ุชูุฒูุน ุงูุญุตุต ุนูู ุงูุฃูุงู ูุงููุชุฑุงุช ุงูุฒูููุฉ
4. ุงุฎุชูุงุฑ ุงููุงุนุงุช ุงููุชุงุญุฉ
5. ุงูุชุญูู ูู ุงูุชุนุงุฑุถุงุช
6. ุฅุฑุฌุงุน ุงููุชุงุฆุฌ ูุน ุงูุชูุงุฑูุฑ
```

---

### 3. **ุตูุญุฉ ููุญุฏุฉ ูููุฉ - ScheduleBuilder**

**ุงูููู:** `src/pages/hr/schedules/ScheduleBuilder.tsx`

#### โจ ุงูููุฒุงุช:
- โ ูุงุฌูุฉ ููุญุฏุฉ ูุฌููุน ุงูุนูููุงุช
- โ ุฅุญุตุงุฆูุงุช ููุฑูุฉ ุดุงููุฉ
- โ ุนุฑุถ ุงูุฌุฏุงูู ุจุทุฑู ูุชุนุฏุฏุฉ (ูุตู/ูุนูู/ูุงุนุฉ)
- โ ุฅูุดุงุก ูุณุฎ ูุชุนุฏุฏุฉ
- โ ุชูููุฏ ุชููุงุฆู ุจุถุบุทุฉ ุฒุฑ
- โ ุชูุจููุงุช ูุงุถุญุฉ ููุชุนุงุฑุถุงุช

#### ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏู:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ุจูุงุก ุงูุฌุฏุงูู ุงููุฏุฑุณูุฉ                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ๐ ุงูุฅุญุตุงุฆูุงุช:                          โ
โ  โข 45/50 ุญุตุฉ ููููุกุฉ (90%)               โ
โ  โข 0 ุชุนุงุฑุถุงุช โ                         โ
โ  โข 5 ูุณุฎ ุฌุงูุฒุฉ                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ๐ฏ ุงูุฎูุงุฑุงุช:                           โ
โ  โข [+ ูุณุฎุฉ ุฌุฏูุฏุฉ]  [โก ุชูููุฏ ุชููุงุฆู]   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ๐ ุงูุชุจููุจุงุช:                          โ
โ  1๏ธโฃ  ุงูุฌุฏูู (ุนุฑุถ + ุชุนุฏูู)              โ
โ  2๏ธโฃ  ุงููุณุฎ (ุฅุฏุงุฑุฉ ุงูุฅุตุฏุงุฑุงุช)            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

### 4. **ุฅุตูุงุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช**

**ุงูููู:** `supabase/migrations/20260101150000_fix_schedule_integrity.sql`

#### โจ ุงูุชุญุณููุงุช:
- โ ุฅุถุงูุฉ INDEXES ููุจุญุซ ุงูุณุฑูุน
- โ ุฅุถุงูุฉ CHECK constraints
- โ ุฅูุดุงุก VIEWs ูุณูููุฉ ุงูุงุณุชุนูุงูุงุช
- โ Triggers ูุชุญุฏูุซ ุงูุจูุงูุงุช ุชููุงุฆูุงู
- โ ุฌุฏูู ูุชุณุฌูู ุงูุชุบููุฑุงุช (Audit Log)
- โ ุฏุงูุฉ ููุดู ุงูุชุนุงุฑุถุงุช ุชููุงุฆูุงู

#### ๐ ุงูู Views ุงูุฌุฏูุฏุฉ:

**schedule_overview** - ุนุฑุถ ุดุงูู ููุฌุฏูู:
```sql
SELECT slot_id, day_name_ar, period_name, class_name, 
       subject_name_ar, teacher_name, room_name
FROM schedule_overview
WHERE version_id = ?
```

**schedule_conflicts_summary** - ููุฎุต ุงูุชุนุงุฑุถุงุช:
```sql
SELECT id, conflict_type, severity, description
FROM schedule_conflicts_summary
WHERE resolved = false
```

---

## ๐ ููุงุฑูุฉ ูุจู ูุจุนุฏ

| ุงููุนูุงุฑ | ูุจู | ุจุนุฏ |
|--------|-----|-----|
| **ุนุฏุฏ ุตูุญุงุช ุงูุฌุฏุงูู** | 3 (ูุชุดุงุจูุฉ) โ | 1 ูููุฉ โ |
| **ุงูุจูุงูุงุช ุงูููููุฉ** | ููุฌูุฏุฉ โ | ูุญุฐููุฉ โ |
| **ูุดู ุงูุชุนุงุฑุถุงุช** | 0 ุชุนุงุฑุถุงุช ููุท โ | ูุธุงู ูุงูู โ |
| **ุงูุชูููุฏ ุงูุชููุงุฆู** | ุบูุฑ ูุนุงู โ | ุฎูุงุฑุฒููุฉ ุฐููุฉ โ |
| **ุงูุฃุฏุงุก** | ุจุทูุก (SmartTimetablePro) โ | ุณุฑูุน ุฌุฏุงู โ |
| **ุงููุถูุญ** | ูุนูุฏ โ | ุจุณูุท ููุงุถุญ โ |
| **ุงูุชุญูู ูู ุงูุจูุงูุงุช** | ุถุนูู โ | ููู ุฌุฏุงู โ |
| **ุงูุฅุญุตุงุฆูุงุช** | ูุนุทูุจุฉ โ | ุฏูููุฉ ุฌุฏุงู โ |

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. **ุงููุตูู ููุตูุญุฉ ุงูุฑุฆูุณูุฉ:**
```
http://localhost:3000/hr/schedules
```

### 2. **ุฅูุดุงุก ูุณุฎุฉ ุฌุฏูุฏุฉ:**
1. ุงููุฑ ุนูู "ูุณุฎุฉ ุฌุฏูุฏุฉ"
2. ุฃุฏุฎู ุงุณู ุงููุณุฎุฉ (ูุซูุงู: "ุงููุตู ุงูุฃูู 2024")
3. ุณูุชู ุชูุนูู ุงููุณุฎุฉ ุชููุงุฆูุงู

### 3. **ุฅุถุงูุฉ ุชูุฒูุน ุงูููุงุฏ:**
ุงูุชูู ุฅูู **HR > Schedules > Teaching Assignments**
ูุฃุถู ุชูุฒูุนุงุช ุงูููุงุฏ ุนูู ุงููุนูููู

### 4. **ุงูุชูููุฏ ุงูุชููุงุฆู:**
1. ุชุฃูุฏ ูู ุฅุถุงูุฉ ุชูุฒูุนุงุช ุงูููุงุฏ
2. ุงููุฑ ุนูู "โก ุชูููุฏ ุชููุงุฆู"
3. ุฑุงุฌุน ุงููุชุงุฆุฌ ูุงูุชุนุงุฑุถุงุช (ุฅู ูุฌุฏุช)
4. ุงุถุบุท "ุญูุธ" ูุชุฃููุฏ

### 5. **ุงูุชุนุฏูู ุงููุฏูู:**
- ุงููุฑ ุนูู ุฃู ุฎููุฉ ูุงุฑุบุฉ ูุฅุถุงูุฉ ุญุตุฉ
- ุงููุฑ ุนูู ุญุตุฉ ููุฌูุฏุฉ ูุชุนุฏูููุง
- ุญุฏุฏ ุงููุนูู ูุงููุงุฏุฉ ูุงููุงุนุฉ

### 6. **ุนุฑุถ ุจุทุฑู ูุฎุชููุฉ:**
ุงุณุชุฎุฏู ููุงุชุฑ "ุนุฑุถ ุงูุฌุฏูู":
- ๐ **ุงููุตู** - ุฌุฏูู ุงููุตู ุงููุงุญุฏ
- ๐จโ๐ซ **ุงููุนูู** - ุฌุฏูู ุงููุนูู ุงููุงุญุฏ
- ๐๏ธ **ุงููุงุนุฉ** - ุงุณุชุฎุฏุงูุงุช ุงููุงุนุฉ

---

## ๐ ุงููุญูุตุงุช ุงูุชู ุชุชู ุชููุงุฆูุงู

ุนูุฏ ุฅุถุงูุฉ ุฃู ุชุนุฏูู ุญุตุฉุ ูุชู ูุญุต:

1. **ุงูุญููู ุงููุทููุจุฉ:**
   - ุงูููู โ
   - ุงููุชุฑุฉ ุงูุฒูููุฉ โ
   - ุงููุตู โ

2. **ุงูุชุนุงุฑุถุงุช ุงูุญุฑุฌุฉ:**
   - ูู ุงููุนูู ูุดุบูู ูู ูุฐุง ุงูููุชุ
   - ูู ุงููุตู ูุฏูู ุญุตุฉ ุฃุฎุฑูุ
   - ูู ุงููุงุนุฉ ูุณุชุฎุฏูุฉุ

3. **ุฅุฐุง ููุฌุฏุช ูุดููุฉ:**
   - ูุชู ุนุฑุถ ุฑุณุงูุฉ ูุงุถุญุฉ โ
   - ูุง ูุชู ุงูุญูุธ ุฅูุง ุจุนุฏ ุงูุญู โ

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ุงููุชููุฑุฉ

ูู ููุญุฉ ุงููุนูููุงุช ุงูุนูููุฉ:

| ุงูุฅุญุตุงุฆูุฉ | ุงููุตู |
|----------|--------|
| **ุงูุญุตุต ุงูููููุกุฉ** | ุนุฏุฏ ุงูุญุตุต ุงูููุฌุฏููุฉ / ุงูุฅุฌูุงูู |
| **ูุณุจุฉ ุงูุฅููุงู** | ุงููุณุจุฉ ุงููุฆููุฉ ูุงูุชูุงู ุงูุฌุฏูู |
| **ุงูุชุนุงุฑุถุงุช** | ุนุฏุฏ ุงูุชุนุงุฑุถุงุช ุงูุญุฑุฌุฉ ุงููุชุจููุฉ |
| **ุนุฏุฏ ุงููุณุฎ** | ุฅุฌูุงูู ุฅุตุฏุงุฑุงุช ุงูุฌุฏูู |

---

## โ๏ธ ุงูุชูููู

### ูู ููู `.env.local`:
```
VITE_SCHEDULE_AUTO_VALIDATE=true     # ุงูุชุญูู ุงูุชููุงุฆู
VITE_SCHEDULE_CONFLICTS_ALERT=true   # ุชูุจููุงุช ุงูุชุนุงุฑุถุงุช
VITE_SCHEDULE_AUTO_SAVE=false        # ุนุฏู ุงูุญูุธ ุงูุชููุงุฆู
```

### ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:
ุฅุนุฏุงุฏุงุช ุงููุฏุฑุณุฉ โ `school_settings`:
```json
{
  "working_days": [0, 1, 2, 3, 4],      // ุฃูุงู ุงูุนูู (ุฃุญุฏ-ุฎููุณ)
  "weekly_rotation_enabled": false,       // ูุธุงู ุงูุชูุงูุจ
  "break_settings": {                     // ุฅุนุฏุงุฏุงุช ุงููุณุญ
    "morning_break": { "after_period": 2, "duration": 20 },
    "lunch_break": { "after_period": 4, "duration": 30 }
  }
}
```

---

## ๐ ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### ุงููุดููุฉ: "ุงูุญููู ูุทููุจุฉ"
**ุงูุญู:** ุชุฃูุฏ ูู ููุก ุงูููู ูุงููุชุฑุฉ ุงูุฒูููุฉ ูุงููุตู ูุงููุนูู

### ุงููุดููุฉ: "ูุนูู ูุดุบูู"
**ุงูุญู:** ุงุฎุชุฑ ูุนููุงู ูุฎุชููุงู ุฃู ููุชุงู ูุฎุชููุงู

### ุงููุดููุฉ: "ุงูุชูููุฏ ูู ูุนูู"
**ุงูุญู:** ุฃุถู ุนูู ุงูุฃูู ุชูุฒูุน ูุงุฏุฉ ูุงุญุฏุฉ ูุจู ุงูุชูููุฏ

### ุงููุดููุฉ: "ุงูุฌุฏูู ุจุทูุก"
**ุงูุญู:** ุฌุฑุจ ุชูููู ุนุฏุฏ ุงูุญุตุต ุฃู ุงุณุชุฎุฏุงู ูุณุฎุฉ ูุฎุชููุฉ

---

## ๐ ุงููููุงุช ุงูููุถุงูุฉ/ุงูููุญุฏุซุฉ

### ูููุงุช ุฌุฏูุฏุฉ:
- โ `src/pages/hr/schedules/ScheduleBuilder.tsx` - ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
- โ `src/utils/scheduleAutoGenerate.ts` - ุฎูุงุฑุฒููุฉ ุงูุชูููุฏ
- โ `supabase/migrations/20260101150000_fix_schedule_integrity.sql` - ุฅุตูุงุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ูููุงุช ูุญุฏุซุฉ:
- โ `src/hooks/useScheduleData.ts` - ุชุญุณูู ุงูู Hook
- โ `src/components/schedules/ScheduleGrid.tsx` - ุนุฑุถ ุงูุชุนุงุฑุถุงุช
- โ `src/types/schedule.ts` - ุชุญุฏูุซ ุงูุฃููุงุน

### ูููุงุช ูููู ุญุฐููุง:
- โ๏ธ `src/pages/hr/schedules/HRSchedules.tsx` - (ุจูุงูุงุช ููููุฉ)
- โ๏ธ `src/pages/hr/schedules/SmartTimetablePro.tsx` - (ูุนูุฏุฉ)

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ (ุงุฎุชูุงุฑูุฉ)

1. **ุชุญุณููุงุช ุงูุฃุฏุงุก:**
   - ุชุทุจูู pagination ุนูู ุงูุฌุฏุงูู ุงููุจูุฑุฉ
   - ุชุฎุฒูู ูุคูุช (Caching) ููุจูุงูุงุช ุงูุซุงุจุชุฉ

2. **ููุฒุงุช ุฅุถุงููุฉ:**
   - ุงุณุชูุฑุงุฏ ูู Excel
   - ุชุตุฏูุฑ ูู PDF
   - ุฌุฏููุฉ ูุชูุฏูุฉ (ุฃุณุงุจูุน ุฏูุงุฑุฉ)

3. **ุงูุชูุงุฑูุฑ:**
   - ุชูุฑูุฑ ุฅุญุตุงุฆู ุดุงูู
   - ุชูุฑูุฑ ุงูุชุนุงุฑุถุงุช
   - ุชูุฑูุฑ ุงุณุชุฎุฏุงู ุงููุงุนุงุช

---

## โ ุงููุงุฆูุฉ ุงูุจูุถุงุก (Checklist)

- [x] ุฅุตูุงุญ ูุดู ุงูุชุนุงุฑุถุงุช
- [x] ุฅูุดุงุก ุฎูุงุฑุฒููุฉ ุงูุชูููุฏ ุงูุชููุงุฆู
- [x] ุจูุงุก ุตูุญุฉ ููุญุฏุฉ ูููุฉ
- [x] ุฅุตูุงุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [x] ุฅุถุงูุฉ ุงูุชุญูู ูู ุงูุตุญุฉ
- [ ] ุงุฎุชุจุงุฑ ุดุงูู ุนูู ุฌููุน ุงูุญุงูุงุช
- [ ] ุชูุซูู ูููุงูุฉ ุงููุณุชุฎุฏู
- [ ] ุชุฏุฑูุจ ูุฑูู ุงูุงุณุชุฎุฏุงู

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2026-01-01  
**ุงููุณุคูู:** ูุธุงู ุงูุฌุฏุงูู ุงููุฏุฑุณูุฉ  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุงุณุชุฎุฏุงู
