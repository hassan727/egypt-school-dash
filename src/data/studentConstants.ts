/**
 * ثوابت بيانات نظام إدارة الطلاب
 * هذا الملف يحتوي على جميع البيانات الثابتة والقوائس الديناميكية
 */

// المراحل الدراسية والفصول المرتبطة بها
export const STAGES_DATA = {
    // رياض الأطفال
    'KG1': ['KG1A', 'KG1B', 'KG1C', 'KG1D'],
    'KG2': ['KG2A', 'KG2B', 'KG2C', 'KG2D'],

    // الابتدائي
    'الصف الأول الابتدائي': ['1A', '1B', '1C', '1D'],
    'الصف الثاني الابتدائي': ['2A', '2B', '2C', '2D'],
    'الصف الثالث الابتدائي': ['3A', '3B', '3C', '3D', '3E'],
    'الصف الرابع الابتدائي': ['4A', '4B', '4C', '4D'],
    'الصف الخامس الابتدائي': ['5A', '5B', '5C', '5D'],
    'الصف السادس الابتدائي': ['6A', '6B', '6C', '6D'],

    // الإعدادي
    'الصف الأول الإعدادي': ['1A PRE', '1B PRE'],
    'الصف الثاني الإعدادي': ['2A PRE', '2B PRE', '2C PRE'],
    'الصف الثالث الإعدادي': ['3A PRE', '3B PRE'],

    // الثانوي
    'الصف الأول الثانوي': ['S1A', 'S1B', 'S1C', 'S1D'],
    'الصف الثاني الثانوي': ['S2A', 'S2B', 'S2C', 'S2D'],
    'الصف الثالث الثانوي': ['S3A', 'S3B', 'S3C', 'S3D'],
};

// الخيارات الثابتة
export const STUDENT_OPTIONS = {
    nationality: [
        'مصري',
        'سعودي',
        'إماراتي',
        'كويتي',
        'قطري',
        'بحريني',
        'عماني',
        'يمني',
        'أردني',
        'لبناني',
        'سوري',
        'عراقي',
        'فلسطيني',
        'سوداني',
        'ليبي',
        'تونسي',
        'جزائري',
        'مغربي',
        'موريتاني',
        'صومالي',
        'جيبوتي',
        'قمري',
        'أخرى'
    ],
    gender: ['ذكر', 'أنثى'],
    religion: ['مسلم', 'مسيحي'],
    enrollmentType: ['مستجد', 'تحويل', 'عائد من سفر'],
    academicLevel: ['تفوق', 'جيد', 'يحتاج دعم'],
    secondLanguage: ['ألماني', 'فرنسي', 'إيطالي'],
    curriculumType: ['وطني', 'دولي', 'لغات'],
    relationshipTypes: ['والد', 'والدة', 'أخ', 'أخت', 'جد', 'جدة', 'عم', 'عمة', 'أخرى'],
    academicDegrees: ['ابتدائي', 'إعدادي', 'ثانوي', 'دبلوم', 'بكالوريوس', 'ماجستير', 'دكتوراه'],
    maritalStatus: ['أعزب', 'متزوج', 'مطلق', 'أرمل'],
    academicYears: ['2025-2026', '2026-2027', '2027-2028'],
};

// أنواع المصروفات
export const EXPENSE_TYPES = ['كتب', 'باص', 'زي مدرسي', 'معدات', 'أخرى'];

// أنواع صلة القرابة للوصاية القانونية
export const LEGAL_GUARDIAN_RELATIONSHIPS = [
    'أب',
    'أم',
    'جد',
    'جدة',
    'عم',
    'عمة',
    'خال',
    'خالة',
    'أخ',
    'أخت',
    'وصي معين من المحكمة',
    'أخرى'
];

// عدد الأقساط
export const INSTALLMENT_COUNTS = [1, 2, 3, 4, 6, 12];

// === المواد الدراسية الكاملة ===
export const SUBJECTS_LIST = [
    'اللغة العربية',
    'لغة انجليزية',
    'الرياضيات',
    'العلوم',
    'الدراسات',
    'تربية فنية',
    'تربية موسيقية',
    'تربية بدنية',
    'تربية دينية',
    'دين إسلامي',
    'دين مسيحي',
    'القيم واحترام الآخر',
    'اللغة الألمانية',
    'اللغة الفرنسية',
    'اللغة الإيطالية',
    'مستوى رفيع',
    'توكاتسو',
    'ICT',
    'مهارات',
    'اكتشف',
    'نشاط',
    'متعدد التخصصات',
];


// === أنواع التقييمات ===
export const ASSESSMENT_TYPES = [
    'تقييم أسبوعي',
    'تقييم شهري',
    'امتحان شهري',
    'اختبار الفصل الدراسي الأول',
    'مشروع أو بحث',
    'اختبار نهاية العام الدراسي',
    'تقييم سلوكي أو عملي',
];

// === الأشهر للتقييمات الشهرية ===
export const MONTHS = [
    'يناير',
    'فبراير',
    'مارس',
    'أبريل',
    'مايو',
    'يونيو',
    'يوليو',
    'أغسطس',
    'سبتمبر',
    'أكتوبر',
    'نوفمبر',
    'ديسمبر',
];

// === الترمات الدراسية ===
export const SEMESTERS = [
    'الترم الأول',
    'الترم الثاني',
];

// === مستويات الدرجات ===
export const GRADE_LEVELS = [
    'ممتاز',
    'جيد جدًّا',
    'جيد',
    'مقبول',
    'ضعيف',
];

// === أوزان أنواع التقييمات المختلفة ===
export const ASSESSMENT_WEIGHTS: Record<string, number> = {
    'تقييم أسبوعي': 0.10, // 10%
    'تقييم شهري': 0.15, // 15%
    'امتحان شهري': 0.20, // 20%
    'اختبار الفصل الدراسي الأول': 0.25, // 25%
    'مشروع أو بحث': 0.15, // 15%
    'اختبار نهاية العام الدراسي': 0.30, // 30% (الأهم)
    'تقييم سلوكي أو عملي': 0.10, // 10%
};

// === دالة لحساب مستوى الدرجة بناءً على القيمة ===
export function calculateGradeLevel(grade: number): 'ممتاز' | 'جيد جدًّا' | 'جيد' | 'مقبول' | 'ضعيف' {
    if (grade >= 90) return 'ممتاز';
    if (grade >= 80) return 'جيد جدًّا';
    if (grade >= 70) return 'جيد';
    if (grade >= 60) return 'مقبول';
    return 'ضعيف';
}

// === دالة لحساب الدرجة النهائية مع الأوزان ===
export function calculateWeightedFinalGrade(grades: any[]): number {
    if (grades.length === 0) return 0;

    let totalWeightedGrade = 0;
    let totalWeight = 0;

    // تجميع الدرجات حسب نوع التقييم وحساب المتوسط لكل نوع
    const gradesByType: Record<string, number[]> = {};

    grades.forEach(grade => {
        if (!gradesByType[grade.assessmentType]) {
            gradesByType[grade.assessmentType] = [];
        }
        gradesByType[grade.assessmentType].push(grade.finalGrade);
    });

    // حساب المتوسط المرجح
    Object.entries(gradesByType).forEach(([type, typeGrades]) => {
        const averageForType = typeGrades.reduce((a, b) => a + b, 0) / typeGrades.length;
        const weight = ASSESSMENT_WEIGHTS[type] || 0.1;
        totalWeightedGrade += averageForType * weight;
        totalWeight += weight;
    });

    // إذا كان المجموع الكامل للأوزان أقل من 1، نطبيع النتيجة
    return totalWeight > 0 ? (totalWeightedGrade / totalWeight) : 0;
}